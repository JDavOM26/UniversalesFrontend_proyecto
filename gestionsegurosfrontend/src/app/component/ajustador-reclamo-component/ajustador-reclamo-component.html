<app-navbar-component></app-navbar-component>
<br><br><br>


<div class="crear-paquetes-contenedor">
  <mat-card>
    <h2>Buscar Pólizas</h2>
    <mat-card-content>
      <div class="filter-container">
        <mat-form-field appearance="fill">
          <mat-label>Valor de búsqueda</mat-label>
          <input matInput placeholder="Escribe para buscar..." [(ngModel)]="valorBusqueda">
          <button mat-icon-button matSuffix color="primary" aria-label="Botón de búsqueda" [disabled]="isLoading"
            (click)="buscarPolizasPaginado()">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </div>
      
    </mat-card-content>
     <h2>Emitir reclamo</h2>
    <mat-card-content>
      

      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="dataSourcePaginado" matSort>
          
          
          <ng-container matColumnDef="idPoliza">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID Póliza</th>
            <td mat-cell *matCellDef="let element">{{ element.idPoliza }}</td>
          </ng-container>

         
          <ng-container matColumnDef="nombrePoliza">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre Póliza</th>
            <td mat-cell *matCellDef="let element">{{ element.nombrePoliza }}</td>
          </ng-container>

          
          <ng-container matColumnDef="contratante">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID Contratante</th>
            <td mat-cell *matCellDef="let element">{{ element.contratante }}</td>
          </ng-container>

          
          <ng-container matColumnDef="nombreContratante">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre Contratante</th>
            <td mat-cell *matCellDef="let element">{{ element.nombreContratante }}</td>
          </ng-container>

          
          <ng-container matColumnDef="fechaCreacion">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Inicio</th>
            <td mat-cell *matCellDef="let element">{{ element.fechaCreacion | date:'short' }}</td>
          </ng-container>

          
          <ng-container matColumnDef="fechaVencimiento">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Fin</th>
            <td mat-cell *matCellDef="let element">{{ element.fechaVencimiento | date:'short' }}</td>
          </ng-container>

          
          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
            <td mat-cell *matCellDef="let element">
              <span [class]="element.estado === 'activa' ? 'estado-activa' : 'estado-inactiva'">
                {{ element.estado | titlecase }}
              </span>
            </td>
          </ng-container>

          
          <ng-container matColumnDef="primaVendidaTotal">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Prima Total</th>
            <td mat-cell *matCellDef="let element">{{ element.primaVendidaTotal | currency }}</td>
          </ng-container>

          
          <ng-container matColumnDef="idPaquete">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID Paquete</th>
            <td mat-cell *matCellDef="let element">{{ element.idPaquete || '-' }}</td>
          </ng-container>

          
          <ng-container matColumnDef="vendedor">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Vendedor</th>
            <td mat-cell *matCellDef="let element">{{ element.vendedor }}</td>
          </ng-container>

         
          <ng-container matColumnDef="accion">
            <th mat-header-cell *matHeaderCellDef>Acción</th>
            <td mat-cell *matCellDef="let element">
              @if (element.estado === 'activa') {
                <button class="btn btn-outline-success" (click)="openDialog(element)">
                  Crear Reclamo
                </button>
              } @else {
                <span class="text-muted">Inactiva</span>
              }
            </td>
          </ng-container>

          
           
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                <mat-paginator #paginator2 [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
            </div>
        </mat-card-content>
  </mat-card>
</div>
<br><br><br>



<app-progress-spinner-component *ngIf="isLoading"></app-progress-spinner-component>

